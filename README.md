
# Система визуального скриптинга для игровых логических цепочек

## Описание проекта
Проект представляет собой систему визуального скриптинга для построения логических цепочек в играх. Система позволяет пользователю создавать узлы, соединять их между собой, задавать параметры и отслеживать выполнение логики в реальном времени. Проект реализован с использованием инструментов разработки программного обеспечения с открытым исходным кодом и ориентирован на гибкость, расширяемость и удобство визуального редактирования.

## Структура проекта

visual-scripting-system/

├── client/

│   ├── src/

│   │   ├── components/

│   │   │   ├── Editor.tsx

│   │   │   ├── Sidebar.tsx

│   │   │   └── nodes/

│   │   │       ├── CompareNode.tsx

│   │   │       ├── MathNode.tsx

│   │   │       └── index.ts

│   │   ├── core/

│   │   │   ├── graphStore.ts

│   │   │   ├── executor.ts

│   │   │   ├── validation.ts

│   │   │   └── serializer.ts

│   │   ├── App.tsx

│   │   └── main.tsx

│   ├── package.json

│   └── tsconfig.json

├── server/

│   ├── src/

│   │   ├── routes/

│   │   │   ├── graph.ts

│   │   │   ├── templates.ts

│   │   │   ├── files.ts

│   │   │   └── execute.ts


│   │   ├── store/

│   │   │   └── index.ts

│   │   ├── services/

│   │   │   ├── serialize.ts

│   │   │   ├── validate.ts

│   │   │   └── logger.ts

│   │   ├── templates/

│   │   │   └── nodes.ts

│   │   └── server.ts

│   ├── package.json

│   └── tsconfig.json

├── README.md

└── .gitignore


## Установка и запуск

### Клиентская часть
1. Перейти в директорию `client`:
```bash
cd client
```
2. Установить зависимости:
```bash
npm install
```
3. Запустить локальный сервер разработки:
```bash
npm start
```
4. Собрать проект для продакшн:
```bash
npm run build
```

### Серверная часть

1. Перейти в директорию server:
```bash
cd server
```
2. Установить зависимости:
```bash
npm install
```
3. Запустить сервер:
```bash
node server.js
```

## Описание API ключевых модулей

### Модуль хранения графа (graphStore)
**Расположение:** `client/src/core/graphStore.ts`  
**Назначение:** хранение и управление состоянием визуального графа, включая список узлов и связей между ними. Модуль обеспечивает централизованный доступ к данным графа и используется всеми компонентами клиентской части приложения.

### Модуль выполнения логических цепочек (executor)
**Расположение:** `client/src/core/executor.ts`  
**Назначение:** выполнение логических цепочек путём обхода графа и обработки узлов в соответствии с их типом. Отвечает за последовательность выполнения и передачу данных между элементами графа.

### Модуль проверки корректности (validation)
**Расположение:** `client/src/core/validation.ts`  
**Назначение:** проверка корректности построенных логических цепочек и допустимости соединений между узлами. Предотвращает создание некорректных связей на этапе редактирования графа.

### Модуль сериализации данных (serializer)
**Расположение:** `client/src/core/serializer.ts`  
**Назначение:** преобразование структуры графа в формат JSON и восстановление состояния графа из сохранённых данных. Используется для сохранения, загрузки и передачи логических цепочек.

### Серверный модуль обработки графов
**Расположение:** `server/src/routes/graph.ts`  
**Назначение:** обработка серверных запросов, связанных с сохранением, загрузкой и очисткой графов. Обеспечивает взаимодействие клиентской части с серверным хранилищем данных.

### Серверный модуль шаблонов узлов
**Расположение:** `server/src/routes/templates.ts`  
**Назначение:** предоставление клиенту информации о доступных типах узлов и их параметрах. Используется для динамического формирования интерфейса визуального редактора.

### Серверный модуль валидации
**Расположение:** `server/src/services/validate.ts`  
**Назначение:** серверная проверка корректности структуры графа перед сохранением или выполнением. Обеспечивает дополнительный уровень защиты данных и устойчивость системы.

## Запуск тестов

В проекте предусмотрены юнит-тесты для проверки корректности работы ключевых модулей клиентской и серверной части. Тестирование выполняется с использованием фреймворка Jest и позволяет убедиться в стабильности логики работы графа, корректности выполнения узлов и правильной обработки серверных маршрутов.

### Предварительные требования
Перед запуском тестов необходимо убедиться, что на компьютере установлены:
- Node.js (LTS-версия);
- npm;
- клонированный репозиторий проекта.

### Установка зависимостей
Перед первым запуском тестов необходимо установить зависимости для соответствующей части проекта.

Для клиентской части:
```bash
cd client
npm install
```

Для серверной части:
```bash
cd server
npm install
```
Сервер обрабатывает хранение графов, валидацию данных и обеспечивает взаимодействие клиента с ядром выполнения логики.

### Запуск тестов клиентской части
Юнит-тесты клиентской части проверяют работу модулей хранения графа, выполнения логики и валидации данных.

Для запуска тестов необходимо выполнить команду:
```bash
npm test
```
В результате в терминале будет выведен отчёт о выполнении тестов с указанием количества успешно пройденных проверок и возможных ошибок.

### Запуск тестов серверной части
Тесты серверной части направлены на проверку REST-маршрутов и корректности обработки данных на стороне сервера.

Для запуска тестов серверной части необходимо выполнить:
```bash
npm test
```
При успешном выполнении всех тестов в консоли появится сообщение о прохождении всех проверок без ошибок.

## Результаты выполнения:
После завершения тестирования в терминале отображается:
- список протестированных модулей.
- статус выполнения каждого теста.
- общее время выполнения.

Успешное прохождение тестов подтверждает корректность работы ключевых компонентов системы и готовность проекта к дальнейшему использованию и расширению.

## Функциональность
- Добавление и редактирование узлов различных типов (математические, логические, события).
- Соединение узлов для создания игровых логических цепочек.
- Подсветка активных узлов во время исполнения графа.
- Сохранение и загрузка графов в формате JSON.
- Обработка ошибок и некорректных данных с уведомлениями пользователя.
- Интеграция клиентской части с сервером через REST-маршруты.

## Используемые технологии
- React + TypeScript — клиентский интерфейс.
- Node.js + Express — серверная часть.
- JSON — сериализация состояния графа.
- Открытые лицензии — возможность модификации и расширения проекта.

## Применение
- Обучение визуальному программированию.
- Прототипирование игровых сценариев.
- Создание интерактивной логики персонажей и событий.
- Автоматизация тестирования игровых цепочек.

## Автор
Семенов Семен Евгеньевич, группа ИКБО-30-24


